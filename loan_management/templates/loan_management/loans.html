{% extends 'common_base.html' %}
{% block common_title %}Loans List{% endblock %}
{% block common_body %}
  <!-- Loans List -->
  {% for message in messages %}
    <div class="mb-4 rounded-md p-4 text-sm {% if message.tags == 'error' %} bg-red-100 text-red-700 {% elif message.tags == 'success' %} bg-green-100 text-green-700 {% elif message.tags == 'warning' %} bg-yellow-100 text-yellow-700 {% elif message.tags == 'info' %} bg-blue-100 text-blue-700 {% else %} bg-gray-100 text-gray-700 {% endif %}"
         role="alert">
      <p class="font-medium">{{ message }}</p>
    </div>
  {% endfor %}
  <div class="bg-white rounded-md">
    <table class='min-w-full divide-y divide-y-gray-200'>
      <thead class="bg-gray-50">
        <tr>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Loan ID</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Member</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Amount</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Outstanding</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Frequency</th>
          <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
        </tr>
      </thead>
      <tbody class="bg-white divide-y divide-gray-200">
        {% for loan in loans %}
          <tr class="hover:bg-gray-50">
            <td class="px-6 py-4 whitespace-nowrap">
              <a href="{% url 'loan:loan' loan.id %}"
                 class="text-blue-600 hover:text-blue-900">#{{ loan.id }}</a>
            </td>
            <td class="px-6 py-4 whitespace-nowrap">{{ loan.member.name }}</td>
            <td class="px-6 py-4 whitespace-nowrap">${{ loan.amount }}</td>
            <td class="px-6 py-4 whitespace-nowrap">${{ loan.outstanding_principal }}</td>
            <td class="px-6 py-4 whitespace-nowrap">
              <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full {% if loan.status == 'ACTIVE' %}bg-green-100 text-green-800 {% elif loan.status == 'PENDING' %}bg-yellow-100 text-yellow-800 {% elif loan.status == 'FULLYPAID' %}bg-blue-100 text-blue-800 {% elif loan.status == 'DEFAULTED' %}bg-red-100 text-red-800 {% else %}bg-gray-100 text-gray-800{% endif %}">
                {{ loan.get_status_display }}
              </span>
            </td>
            <td class="px-6 py-4 whitespace-nowrap">{{ loan.payment_frequency }}</td>
            <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
              <a href="{% url 'loan:loan' loan.id %}"
                 class="text-blue-600 hover:text-blue-900 mr-4">View</a>
            </td>
          </tr>
        {% empty %}
          <tr>
            <td colspan="7" class="px-6 py-4 text-center text-gray-500">No loans found</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
{% endblock %}
